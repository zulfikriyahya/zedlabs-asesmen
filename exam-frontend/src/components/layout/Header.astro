---
// src/components/layout/Header.astro
import { $authStore } from '@/stores/auth';

interface Props {
  hideNav?: boolean;
}

const { hideNav = false } = Astro.props;
---

<header class="navbar bg-base-100 shadow-md">
  <div class="flex-1">
    <a href="/" class="btn btn-ghost text-xl normal-case">
      <svg class="h-8 w-8" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 2L3 9v12h6v-7h6v7h6V9l-9-7z"></path>
      </svg>
      <span class="ml-2">Sistem Ujian</span>
    </a>
  </div>

  {
    !hideNav && (
      <div class="flex-none">
        <div class="dropdown dropdown-end">
          <label tabindex="0" class="avatar btn btn-circle btn-ghost">
            <div class="w-10 rounded-full">
              <svg class="h-full w-full" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
              </svg>
            </div>
          </label>
          <ul
            tabindex="0"
            class="menu dropdown-content menu-sm z-[1] mt-3 w-52 rounded-box bg-base-100 p-2 shadow"
          >
            <li>
              <a href="/profile" class="justify-between">
                Profile
                <span class="badge">New</span>
              </a>
            </li>
            <li>
              <a href="/settings">Pengaturan</a>
            </li>
            <li>
              <button id="logout-btn">Logout</button>
            </li>
          </ul>
        </div>
      </div>
    )
  }
</header>

<script>
  import { logout } from '@/lib/api/auth';

  const logoutBtn = document.getElementById('logout-btn');

  logoutBtn?.addEventListener('click', async () => {
    if (confirm('Yakin ingin logout?')) {
      try {
        await logout();
      } catch (error) {
        console.error('Logout error:', error);
      }
    }
  });
</script>
